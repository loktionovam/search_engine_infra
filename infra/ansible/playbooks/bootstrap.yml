---
- name: Setup local environment to start repository usage
  hosts: localhost
  connection: local

  tasks:

    - name: Download and install kubectl 1.12.0
      get_url:
        url: https://storage.googleapis.com/kubernetes-release/release/v1.12.0/bin/linux/amd64/kubectl
        dest: /usr/local/bin/
        mode: 0755
      become: true

    - name: Download and install helm 2.11.0
      unarchive:
        src: https://storage.googleapis.com/kubernetes-helm/helm-v2.11.0-linux-amd64.tar.gz
        dest: /usr/local/bin
        extra_opts: ['--strip-components=1', 'linux-amd64/helm']
        mode: 0755
        remote_src: true
      become: true

    - name: Create terraform plugins directory
      file:
        path: ~/.terraform.d/plugins/
        state: directory

    - name: Download and install terraform helm provider 0.6.0
      unarchive:
        src: https://github.com/terraform-providers/terraform-provider-helm/releases/download/v0.6.0/terraform-provider-helm_v0.6.0_linux_amd64.tar.gz
        dest: ~/.terraform.d/plugins/
        extra_opts: ['--strip-components=1', 'terraform-provider-helm_linux_amd64/terraform-provider-helm']
        mode: 0755
        remote_src: true

    - name: Download and install terraform 0.11.8
      unarchive:
        src: https://releases.hashicorp.com/terraform/0.11.8/terraform_0.11.8_linux_amd64.zip
        dest: /usr/local/bin
        remote_src: true
      become: true

    - name: Download and install packer 1.2.4
      unarchive:
        src: https://releases.hashicorp.com/packer/1.2.4/packer_1.2.4_linux_amd64.zip
        dest: /usr/local/bin
        remote_src: true
      become: true
